int n
list int p
int v
list list list int v_

init v_ [10,10,3]
if (null v_) then
  skip
else
  skip
fi (1)
v_[0,1,0] ^= 1
from (v_[0,1,0]) do
  if (v_[0,1,0]) then
    swap v_[0,1,0] v_[1,1,1]
  else
  if (v_[1,1,1]) then
    n += 1829
    v += 2
    swap v_[1,1,1] v_[1,1,2]
  else
  if (v_[1,1,2]) then
    swap v_[1,1,2] v_[1,2,0]
  else
  if (v_[1,2,0] || v_[7,2,0]) then
    if (v_[1,2,0]) then
      swap v_[1,2,0] v_[2,2,1]
    else
      swap v_[7,2,0] v_[2,2,1]
    fi (empty p && v = 2)
  else
  if (v_[2,2,1]) then
    swap v_[2,2,1] v_[2,2,2]
  else
  if (v_[2,2,2]) then
    if (n % v = 0) then
      swap v_[2,2,2] v_[2,3,0]
    else
      swap v_[2,2,2] v_[2,4,0]
    fi (v_[2,3,0])
  else
  if (v_[2,3,0]) then
    swap v_[2,3,0] v_[3,3,1]
  else
  if (v_[3,3,1]) then
    n /= v
    push v p
    v ^= top p
    swap v_[3,3,1] v_[3,3,2]
  else
  if (v_[3,3,2]) then
    swap v_[3,3,2] v_[3,5,0]
  else
  if (v_[2,4,0]) then
    swap v_[2,4,0] v_[4,4,1]
  else
  if (v_[4,4,1]) then
    v += 1
    swap v_[4,4,1] v_[4,4,2]
  else
  if (v_[4,4,2]) then
    swap v_[4,4,2] v_[4,5,0]
  else
  if (v_[3,5,0] || v_[4,5,0]) then
    if (v_[3,5,0]) then
      swap v_[3,5,0] v_[5,5,1]
    else
      swap v_[4,5,0] v_[5,5,1]
    fi (not (empty p) && top p = v)
  else
  if (v_[5,5,1]) then
    swap v_[5,5,1] v_[5,5,2]
  else
  if (v_[5,5,2]) then
    swap v_[5,5,2] v_[5,6,0]
  else
  if (v_[5,6,0]) then
    swap v_[5,6,0] v_[6,6,1]
  else
  if (v_[6,6,1]) then
    skip
    swap v_[6,6,1] v_[6,6,2]
  else
  if (v_[6,6,2]) then
    swap v_[6,6,2] v_[6,7,0]
  else
  if (v_[6,7,0]) then
    swap v_[6,7,0] v_[7,7,1]
  else
  if (v_[7,7,1]) then
    swap v_[7,7,1] v_[7,7,2]
  else
  if (v_[7,7,2]) then
    if (n = 1) then
      swap v_[7,7,2] v_[7,8,0]
    else
      swap v_[7,7,2] v_[7,2,0]
    fi (v_[7,8,0])
  else
  if (v_[7,8,0]) then
    swap v_[7,8,0] v_[8,8,1]
  else
  if (v_[8,8,1]) then
    v -= top p
    n -= 1
    swap v_[8,8,1] v_[8,8,2]
  else
  if (v_[8,8,2]) then
    swap v_[8,8,2] v_[8,9,0]
  else
  if (0) then
    skip
  else
    skip
  fi (1)
  fi (v_[8,9,0])
  fi (v_[8,8,2])
  fi (v_[8,8,1])
  fi (v_[7,8,0] || v_[7,2,0])
  fi (v_[7,7,2])
  fi (v_[7,7,1])
  fi (v_[6,7,0])
  fi (v_[6,6,2])
  fi (v_[6,6,1])
  fi (v_[5,6,0])
  fi (v_[5,5,2])
  fi (v_[5,5,1])
  fi (v_[4,5,0])
  fi (v_[4,4,2])
  fi (v_[4,4,1])
  fi (v_[3,5,0])
  fi (v_[3,3,2])
  fi (v_[3,3,1])
  fi (v_[2,3,0] || v_[2,4,0])
  fi (v_[2,2,2])
  fi (v_[2,2,1])
  fi (v_[1,2,0])
  fi (v_[1,1,2])
  fi (v_[1,1,1])
loop
  skip
until (v_[8,9,0])
v_[8,9,0] ^= 1
if (null v_) then
  skip
else
  skip
fi (1)
free v_ [10,10,3]
