n += 1
v += top (p)
from (n = 1) do
  if (n % v = 0) then
    n /= v
    push v p
    v ^= top (p)
  else
    v += 1
  fi (not (empty (p)) && top (p) = v)
until (empty (p) && v = 2)
n -= 315
v -= 2
